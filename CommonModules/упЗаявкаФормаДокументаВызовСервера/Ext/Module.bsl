#Область ПрограммныйИнтерфейс

#Область Взаиморасчеты

// Процедура - Загрузить взаиморасчеты с партнерами на сервере
//
// Параметры:
//  Организация				 - СправочникСсылка.Организации 	 - организация.
//  Заказчик					 - СправочникСсылка.упПартнеры 	 - заказчик.
//  ВзаиморасчетыАдресХранилища	 - Идентификатор	 - адрес хранилища.
//
Процедура ЗагрузитьВзаиморасчетыСПартнерамиНаСервере(Организация, Заказчик, ВзаиморасчетыАдресХранилища) Экспорт
	
	мсвПараметры = Новый Массив;
	мсвПараметры.Добавить(Заказчик);
	мсвПараметры.Добавить(Организация);
	мсвПараметры.Добавить(ВзаиморасчетыАдресХранилища);
	ФоновыеЗадания.Выполнить("упВзаиморасчеты.СостояниеВзаиморасчетовСКлиентом", мсвПараметры);	
	
КонецПроцедуры

// Процедура - Сформировать таблицу взаиморасчетов
//
// Параметры:
//  ТабличныйДокумент	 - ТабличныйДокумент	 - результат.
//  СтрокаXML			 - Строка	 -  данные.
//
Процедура СформироватьТаблицуВзаиморасчетов(ТабличныйДокумент, СтрокаXML) Экспорт
	
	ТабличныйДокумент.Очистить();
	
	тбзВзаиморасчеты = упВзаиморасчеты.СформироватьТаблицуВзаиморасчетовСКлиентами(СтрокаXML);
	
	текСхемаКомпоновкиДанных	= ПолучитьОбщийМакет("упВзаиморасчетыСКлиентами");
	
	текКомпоновщикМакетаКомпоновкиДанных	= Новый КомпоновщикМакетаКомпоновкиДанных;
	
	текМакетКомпоновкиДанных	= текКомпоновщикМакетаКомпоновкиДанных.Выполнить(текСхемаКомпоновкиДанных, текСхемаКомпоновкиДанных.НастройкиПоУмолчанию);
	
	текПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
	
	текПроцессорКомпоновкиДанных.Инициализировать(текМакетКомпоновкиДанных, Новый Структура("тбзВзаиморасчеты", тбзВзаиморасчеты), );
	
	текПроцессорВыводаРезультата = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	
	текПроцессорВыводаРезультата.УстановитьДокумент(ТабличныйДокумент);
	
	текПроцессорВыводаРезультата.Вывести(текПроцессорКомпоновкиДанных);
		
КонецПроцедуры

#КонецОбласти

// Функция - Получить график работы
//
// Параметры:
//  Партнер	 - СправочникСсылка.упПартнеры - партнер.
//  Адрес		 - СправочникСсылка.упАдреса	 - адрес.
// 
// Возвращаемое значение:
//  СправочникСсылка.Календари - график работы.
//
Функция ПолучитьГрафикРаботы(Партнер, Адрес) Экспорт
	Возврат Справочники.упПартнеры.ПолучитьГрафикРаботыТочкиПартнера(Партнер, Адрес); 
Конецфункции 

// Функция - Получить основного контрагента
//
// Параметры:
//  Партнер	 - СправочникСсылка.упПартнеры 	 - партнер.
// 
// Возвращаемое значение:
//  СправочникСсылка.упКонтрагенты  - контрагент.
//
Функция ПолучитьОсновногоКонтрагента(Партнер) Экспорт
	Возврат Справочники.упКонтрагенты.ПолучитьОсновногоКонтрагента(Партнер);	
КонецФункции

// Функция - Получить основное соглашение
//
// Параметры:
//  Партнер	 - СправочникСсылка.упПартнеры 	 - партнер.
//  Организация - СправочникСсылка.Организации 	 - организация.
// 
// Возвращаемое значение:
//  СправочникСсылка.упСоглашенияСКлиентами  - соглашение.
//
Функция ПолучитьОсновноеСоглашение(Партнер, Организация) Экспорт
	Возврат Справочники.упСоглашенияСКлиентами.СоглашениеПоУмолчанию(Партнер, Организация);
КонецФункции 

#КонецОбласти